library(ggplot2)
library(dplyr)
library(statsr)
library(dplyr)
library(statsr)
library(ggplot2)
load("gss.Rdata")
View(gss)
suicide_dis <- gss %>% select(year, SUICIDE1) %>%
filter(year %in% c(1972, 2012))
suicide_dis <- gss %>% select(year, suicide1) %>%
filter(year %in% c(1972, 2012))
suicide_dis <- gss %>% select(year, suicide1) %>%
filter(year %in% c(1972, 2012))
suicide_liv <- gss %>% select(year, suicide4) %>%
filter(year %in% c(1972, 2012))
library(dplyr)
library(statsr)
library(ggplot2)
library(janitor)
library(dplyr)
library(statsr)
library(janitor)
library(ggplot2)
# choose data subset
suicide_dis <- gss %>% select(year, suicide1) %>%
filter(year %in% c(1972, 2012))
suicide_liv <- gss %>% select(year, suicide4) %>%
filter(year %in% c(1972, 2012))
# convert factor variables
suicide_dis$suicide1 <- unfactor(suicide_dis$suicide1)
library(dplyr)
library(statsr)
library(janitor)
library(varhandle)
library(ggplot2)
# choose data subset
suicide_dis <- gss %>% select(year, suicide1) %>%
filter(year %in% c(1972, 2012))
suicide_liv <- gss %>% select(year, suicide4) %>%
filter(year %in% c(1972, 2012))
# convert factor variables
suicide_dis$suicide1 <- unfactor(suicide_dis$suicide1)
suicide_liv$suicide4 <- unfactor(suicide_liv$suicide4)
# choose data subset
suicide_dis <- gss %>% select(year, suicide1) %>%
filter(year %in% c(1972, 2012))
suicide_liv <- gss %>% select(year, suicide4) %>%
filter(year %in% c(1972, 2012))
# convert factor variables
suicide_dis$suicide1 <- unfactor(suicide_dis$suicide1)
suicide_liv$suicide4 <- unfactor(suicide_liv$suicide4)
# convert year as character
suicide_dis$year <- as.character(suicide_dis$year)
suicide_liv$year <- as.character(suicide_liv$year)
# choose data subset
suicide_dis <- gss %>% select(year, suicide1) %>%
filter(year %in% c(1972, 2012)) %>% na.omit()
suicide_liv <- gss %>% select(year, suicide4) %>%
filter(year %in% c(1972, 2012))
# convert factor variables
suicide_dis$suicide1 <- unfactor(suicide_dis$suicide1)
suicide_liv$suicide4 <- unfactor(suicide_liv$suicide4)
# convert year as character
suicide_dis$year <- as.character(suicide_dis$year)
suicide_liv$year <- as.character(suicide_liv$year)
# choose data subset
suicide_dis <- gss %>% select(year, suicide1) %>%
filter(year %in% c(1972, 2012)) %>% na.omit()
suicide_liv <- gss %>% select(year, suicide4) %>%
filter(year %in% c(1972, 2012)) %>% na.omit()
# convert factor variables
suicide_dis$suicide1 <- unfactor(suicide_dis$suicide1)
suicide_liv$suicide4 <- unfactor(suicide_liv$suicide4)
# convert year as character
suicide_dis$year <- as.character(suicide_dis$year)
suicide_liv$year <- as.character(suicide_liv$year)
# create a cross-tabulation
tabyl(suicide_dis, year, suicide1) %>% adorn_totals(c("row", "col"))
View(suicide_dis)
# choose data subset
suicide_dis <- gss %>% select(year, suicide1) %>%
filter(year == 1972 | year == 2012)) %>% na.omit()
# choose data subset
suicide_dis <- gss %>% select(year, suicide1) %>%
filter(year==1972 | year==2012)) %>% na.omit()
# choose data subset
suicide_dis <- gss %>% select(year, suicide1) %>%
filter(year==1972 | year==2012) %>% na.omit()
suicide_liv <- gss %>% select(year, suicide4) %>%
filter(year %in% c(1972, 2012)) %>% na.omit()
# convert factor variables
suicide_dis$suicide1 <- unfactor(suicide_dis$suicide1)
suicide_liv$suicide4 <- unfactor(suicide_liv$suicide4)
# convert year as character
suicide_dis$year <- as.character(suicide_dis$year)
suicide_liv$year <- as.character(suicide_liv$year)
# create a cross-tabulation
tabyl(suicide_dis, year, suicide1) %>% adorn_totals(c("row", "col"))
View(suicide_dis)
# choose data subset
suicide_dis <- gss %>% select(year, suicide1)
suicide_liv <- gss %>% select(year, suicide4) %>%
filter(year %in% c(1972, 2012)) %>% na.omit()
# convert factor variables
suicide_dis$suicide1 <- unfactor(suicide_dis$suicide1)
suicide_liv$suicide4 <- unfactor(suicide_liv$suicide4)
# convert year as character
suicide_dis$year <- as.character(suicide_dis$year)
suicide_liv$year <- as.character(suicide_liv$year)
View(suicide_dis)
# choose data subset
suicide_dis <- gss %>% select(year, suicide1)%>%
filter(year %in% c(1982, 2012)) %>% na.omit()
suicide_liv <- gss %>% select(year, suicide4) %>%
filter(year %in% c(1982, 2012)) %>% na.omit()
# convert factor variables
suicide_dis$suicide1 <- unfactor(suicide_dis$suicide1)
suicide_liv$suicide4 <- unfactor(suicide_liv$suicide4)
# convert year as character
suicide_dis$year <- as.character(suicide_dis$year)
suicide_liv$year <- as.character(suicide_liv$year)
# create a cross-tabulation
tabyl(suicide_dis, year, suicide1) %>% adorn_totals(c("row", "col"))
# choose data subset
suicide_dis <- gss %>% select(year, suicide1)%>%
filter(year %in% c(1982, 2012)) %>% na.omit() %>% unfactor(suicide_dis$suicide1)
# choose data subset
suicide_dis <- gss %>% select(year, suicide1)%>%
filter(year %in% c(1982, 2012)) %>% na.omit() %>% unfactor(suicide1)
# choose data subset
suicide_dis <- gss %>% select(year, unfactor(suicide1)%>%
filter(year %in% c(1982, 2012)) %>% na.omit()
suicide_liv <- gss %>% select(year, suicide4) %>%
# choose data subset
suicide_dis <- gss %>% select(year, unfactor(suicide1))%>%
filter(year %in% c(1982, 2012)) %>% na.omit()
# choose data subset
suicide_dis <- gss %>% select(year, suicide1)%>%
filter(year %in% c(1982, 2012)) %>% na.omit()
suicide_liv <- gss %>% select(year, suicide4) %>%
filter(year %in% c(1982, 2012)) %>% na.omit()
# convert factor variables
suicide_dis$suicide1 <- unfactor(suicide_dis$suicide1)
suicide_liv$suicide4 <- unfactor(suicide_liv$suicide4)
# convert year as character
suicide_dis$year <- as.character(suicide_dis$year)
suicide_liv$year <- as.character(suicide_liv$year)
# create a summary table including proportions
suicide_dis_table <- table(suicide_dis$year, suicide_dis$suicide1)
prop.table(suicide_dis_table, 1)
0.5902944 - 0.4264706
ggplot(suicide_dis, aes(x=year, fill=suicide1))+
theme(text = element_text(size = 14)) +
labs(x = 'Year', y='Proportion') +
ggtitle('Proportion of people who think suicide is acceptable when having incurable diseases')+
geom_bar(position='fill', color='black')
ggplot(suicide_dis, aes(x=year, fill=suicide1))+
theme(text = element_text(size = 14)) +
labs(x = 'Year', y='Proportion') +
scale_y_continuous(labels = c("0%", "25%", "50%", "75%", "100%")) +
scale_fill_brewer(palette = "Set3")
ggtitle('Proportion of people who think suicide is acceptable when having incurable diseases')+
geom_bar(position='fill', color='black')
library(dplyr)
library(statsr)
library(janitor)
library(varhandle)
library(RColorBrewer)
library(ggplot2)
ggplot(suicide_dis, aes(x=year, fill=suicide1))+
theme(text = element_text(size = 14)) +
labs(x = 'Year', y='Proportion') +
scale_y_continuous(labels = c("0%", "25%", "50%", "75%", "100%")) +
scale_fill_brewer(palette = "Set3")
ggtitle('Proportion of people who think suicide is acceptable when having incurable diseases')+
geom_bar(position='fill', color='black')
ggplot(suicide_dis, aes(x=year, fill=suicide1))+
theme(text = element_text(size = 14)) +
labs(x = 'Year', y='Proportion') +
scale_y_continuous(labels = c("0%", "25%", "50%", "75%", "100%")) +
scale_fill_brewer(palette = "Set3") +
ggtitle('Proportion of people who think suicide is acceptable when having incurable diseases')+
geom_bar(position='fill', color='black')
ggplot(suicide_dis, aes(x=year, fill=suicide1))+
theme(text = element_text(size = 10)) +
labs(x = 'Year', y='Proportion') +
scale_y_continuous(labels = c("0%", "25%", "50%", "75%", "100%")) +
scale_fill_brewer(palette = "Set3") +
ggtitle('Proportion of people who think suicide is acceptable when having incurable diseases')+
geom_bar(position='fill', color='black')
ggplot(suicide_dis, aes(x=year, fill=suicide1))+
theme(text = element_text(size = 10)) +
labs(x = 'Year', y='Proportion') +
scale_y_continuous(labels = c("0%", "25%", "50%", "75%", "100%")) +
scale_fill_brewer(palette = "Set3") +
ggtitle('Proportion of attitudes toward suicide if uncurable disease')+
geom_bar(position='fill', color='black')
ggplot(suicide_dis, aes(x=year, fill=suicide1))+
theme(text = element_text(size = 10)) +
labs(x = 'Year', y='Proportion') +
coord_fixed(ratio=2) +
scale_y_continuous(labels = c("0%", "25%", "50%", "75%", "100%")) +
scale_fill_brewer(palette = "Set3") +
ggtitle('Proportion of attitudes toward suicide if uncurable disease')+
geom_bar(position='fill', color='black')
ggplot(suicide_dis, aes(x=year, fill=suicide1))+
theme(text = element_text(size = 10)) +
labs(x = 'Year', y='Proportion') +
coord_fixed(ratio=3) +
scale_y_continuous(labels = c("0%", "25%", "50%", "75%", "100%")) +
scale_fill_brewer(palette = "Set3") +
ggtitle('Proportion of attitudes toward suicide if uncurable disease')+
geom_bar(position='fill', color='black')
ggplot(suicide_dis, aes(x=year, fill=suicide1))+
theme(text = element_text(size = 10)) +
labs(x = 'Year', y='Proportion') +
coord_fixed(ratio=2) +
scale_y_continuous(labels = c("0%", "25%", "50%", "75%", "100%")) +
scale_fill_brewer(palette = "Set3") +
ggtitle('Proportion of attitudes toward suicide if uncurable disease')+
geom_bar(position='fill', color='black')
# create a cross-tabulation
tabyl(suicide_liv, year, suicide4) %>% adorn_totals(c("row", "col"))
# create a summary table including proportions
suicide_liv_table <- table(suicide_liv$year, suicide_liv$suicide4)
prop.table(suicide_liv_table, 1)
ggplot(suicide_liv, aes(x=year, fill=suicide4))+
theme(text = element_text(size = 10)) +
labs(x = 'Year', y='Proportion') +
coord_fixed(ratio=2) +
scale_y_continuous(labels = c("0%", "25%", "50%", "75%", "100%")) +
scale_fill_brewer(palette = "Set3") +
ggtitle('Proportion of attitudes toward suicide if tired of living')+
geom_bar(position='fill', color='black')
0.4264706
2012 0.4097056 0.5902944
0.5902944 - 0.4264706
0.1910828 - 0.1335196
# calculate the standard error
# part1
SE_1 = sqrt((0.590*(1-0.590)/742) + (0.426*(1-0.426)/754))
# part2
SE_2 = sqrt((0.191*(1-0.191)/240)+(0.134*(1-0.134)/239))
# calculate the standard error
# part1
SE_1 = sqrt((0.590*(1-0.590)/742) + (0.426*(1-0.426)/754))
SE_1
# part2
SE_2 = sqrt((0.191*(1-0.191)/240)+(0.134*(1-0.134)/239))
SE_2
No       Yes
1982 0.5735294 0.4264706
2012 0.4097056 0.5902944
1.96*0.026
0.164 + 1.96*0.026
0.164 - 1.96*0.026
0.058 + 1.96*0.034
0.058 - 1.96*0.034
inference(y = suicide1,
x = year,
order = c(2012, 1982),
data=Abortion.Views.Health,
conf_level = 0.95,
statistic = "proportion",
type = "ci",
method = "theoretical",
success = "Yes",
show_eda_plot = FALSE)
inference(y = suicide1,
x = year,
order = c(2012, 1982),
data=suicide_dis,
conf_level = 0.95,
statistic = "proportion",
type = "ci",
method = "theoretical",
success = "Yes",
show_eda_plot = FALSE)
inference(y = suicide4,
x = year,
order = c(2012, 1982),
data=suicide_dis,
conf_level = 0.95,
statistic = "proportion",
type = "ci",
method = "theoretical",
success = "Yes",
show_eda_plot = FALSE)
inference(y = suicide4,
x = year,
order = c(2012, 1982),
data=suicide_liv,
conf_level = 0.95,
statistic = "proportion",
type = "ci",
method = "theoretical",
success = "Yes",
show_eda_plot = FALSE)
(754+742)/3025
(239+240)/3046
#hypothesis test for part 1 with inference function
inference(y = suicide1,
x = year,
order=c(2012,1982),
data=suicide_dis,
statistic = "proportion",
type = "ht",
method = "theoretical",
success = "Yes",
null=0,
alternative = 'twosided')
#hypothesis test for part 1 with inference function
inference(y = suicide4,
x = year,
order=c(2012,1982),
data=suicide_liv,
statistic = "proportion",
type = "ht",
method = "theoretical",
success = "Yes",
null=0,
alternative = 'twosided')
#hypothesis test for part 1 with inference function
inference(y = suicide1,
x = year,
order=c(2012,1982),
data=suicide_dis,
statistic = "proportion",
type = "ht",
method = "theoretical",
success = "Yes",
null=0,
alternative = 'twosided')
#hypothesis test for part 2 with inference function
inference(y = suicide4,
x = year,
order=c(2012,1982),
data=suicide_liv,
statistic = "proportion",
type = "ht",
method = "theoretical",
success = "Yes",
null=0,
alternative = 'twosided')
# For suicide if incurable disease
p_pool_yes = (754+742)/3025
# For suicide if incurable disease
p_pool_yes = (754+742)/3025
p_pool_yes
# For suicide if incurable disease
p_pool_yes = (754+742)/3025
p_pool_yes
# number of success in 1982
1768*p_pool_yes
# number of success in 2012
1257*p_pool_yes
# number of failure in 1982
1768*(1-p_pool_yes)
# number of failure in 2012
1257*(1-p_pool_yes)
# For suicide if tired of living
p_pool_yes = (239+240)/3046
p_pool_yes
# number of success in 1982
1790*p_pool_yes
# number of success in 2012
1256*p_pool_yes
# number of failure in 1982
1790*(1-p_pool_yes)
# number of failure in 2012
1256*(1-p_pool_yes)
# For suicide if incurable disease
p_pool_yes = (754+742)/3025
# number of success in 1982
set1 <- data.frame(c(1768*p_pool_yes, 1768*(1-p_pool_yes)),
c(1257*p_pool_yes, 1257*(1-p_pool_yes)))
View(set1)
?data.frame
View(set1)
# For suicide if incurable disease
p_pool_yes = (754+742)/3025
# number of success in 1982
set1 <- data.frame(c(1768*p_pool_yes, 1768*(1-p_pool_yes)),
c(1257*p_pool_yes, 1257*(1-p_pool_yes)),
row.names <- c("success", "failure"))
View(set1)
# For suicide if incurable disease
p_pool_yes = (754+742)/3025
# number of success in 1982
set1 <- data.frame(c(1768*p_pool_yes, 1768*(1-p_pool_yes)),
c(1257*p_pool_yes, 1257*(1-p_pool_yes)),
row.names = c("success", "failure"))
# For suicide if incurable disease
p_pool_yes = (754+742)/3025
# number of success in 1982
set1 <- data.frame(year1982 <- c(1768*p_pool_yes, 1768*(1-p_pool_yes)),
year2012 <- c(1257*p_pool_yes, 1257*(1-p_pool_yes)),
row.names = c("success", "failure"))
View(set1)
# For suicide if incurable disease
p_pool_yes = (754+742)/3025
# number of success in 1982
year1982 <- c(1768*p_pool_yes, 1768*(1-p_pool_yes))
year2012 <- c(1257*p_pool_yes, 1257*(1-p_pool_yes))
set1 <- data.frame(year1982, year2012,
row.names = c("success", "failure"))
View(set1)
# For suicide if incurable disease
p_pool_yes = (754+742)/3025
# number of success in 1982
year1982 <- c(1768*p_pool_yes, 1768*(1-p_pool_yes))
year2012 <- c(1257*p_pool_yes, 1257*(1-p_pool_yes))
set1 <- data.frame(year1982, year2012,
row.names = c("success", "failure"))
set1
# For suicide if tired of living
p_pool_yes = (239+240)/3046
year1982 <- c(1790*p_pool_yes, 1790*(1-p_pool_yes))
year2012 <- c(1256*p_pool_yes, 1256*(1-p_pool_yes))
set2 <- data.frame(year1982, year2012,
row.names = c("success", "failure"))
set2
